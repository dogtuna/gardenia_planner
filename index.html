<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Fall Garden Plan</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <!-- Chosen Palette: Terracotta & Sage -->
    <!-- Application Structure Plan: The SPA is designed as a task-oriented dashboard, not a linear report. It prioritizes what the user needs to know and do. The structure flows from high-level summary (Dashboard) to time-based tasks (Timeline), detailed information (Plant Library), spatial planning (Bed Layouts), and finally a comprehensive checklist (Action Plan). This non-linear structure allows users to jump to the section most relevant to their immediate question (e.g., "What do I plant in this specific bed?") without reading through everything. Key interactions like filtering the plant library from the timeline create a cohesive, guided experience, making the complex plan easy to digest for a first-time fall gardener. -->
    <!-- Visualization & Content Choices: 
        - Report Info: Climate data (Zone, Frost). Goal: Inform. Viz: Key stat cards. Interaction: Static. Justification: Quick, high-level context. Library/Method: HTML/Tailwind.
        - Report Info: Planting windows from Table 1. Goal: Show change/schedule. Viz: Interactive timeline/calendar view. Interaction: Click a month/period to filter the Plant Library. Justification: More intuitive than a table for understanding seasonal flow. Library/Method: HTML/JS.
        - Report Info: Detailed plant data from Table 1. Goal: Organize/Inform. Viz: Grid of filterable cards. Interaction: Clicking a card reveals a modal with details (spacing, maturity, notes). Justification: Manages complexity via progressive disclosure. Library/Method: HTML/JS.
        - Report Info: Bed-by-bed planting layouts. Goal: Organize spatially. Viz: Interactive visual grid for each bed. Interaction: Hovering over a square reveals a tooltip with plant info. Justification: A direct, visual representation of the physical garden is the most user-friendly way to present this data. Library/Method: HTML/Tailwind Grid/JS.
        - Report Info: Step-by-step action plan. Goal: Inform/Guide. Viz: Collapsible accordion sections. Interaction: Click to expand/collapse phases. Justification: Prevents information overload by hiding details until requested. Library/Method: HTML/JS.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-primary">

    <header class="bg-secondary sticky top-0 z-50 shadow-md">
        <div class="container mx-auto px-4 py-3 flex flex-col sm:flex-row justify-between items-center">
            <h1 class="text-2xl font-bold text-green-accent mb-2 sm:mb-0">My Fall Garden Plan</h1>
            <nav id="navbar" class="flex flex-wrap justify-center gap-2">
                <a href="#dashboard" class="nav-link active">Dashboard</a>
                <a href="#timeline" class="nav-link">Timeline</a>
                <a href="#layouts" class="nav-link">Bed Layouts</a>
                <a href="#plants" class="nav-link">Plant Library</a>
                <a href="#swaps" class="nav-link">Possible Swaps</a>
                <a href="#plan" class="nav-link">Action Plan</a>
            </nav>
        </div>
    </header>

    <main class="container mx-auto p-4 md:p-8">
        
        <section id="dashboard" class="mb-12 scroll-mt-24">
            <h2 class="text-3xl font-bold mb-6 text-center">Gardening Dashboard</h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <div class="bg-white p-6 rounded-lg shadow-lg text-center" id="location-card">
                    <h3 class="font-semibold text-lg mb-2">Location</h3>
                    <p id="location-display" class="text-2xl text-accent">Montgomery, TX</p>
                    <p id="zone-display" class="text-gray-500">USDA Zone 9a</p>
                    <button id="edit-location-btn" class="mt-2 bg-blue-accent text-white px-3 py-1 rounded" onclick="openLocationFormModal()">Edit</button>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg text-center">
                    <h3 class="font-semibold text-lg mb-2">First Frost</h3>
                    <p id="first-frost-display" class="text-2xl text-blue-accent">N/A</p>
                    <div id="first-frost-gauge" class="thermometer-gauge my-2"></div>
                    <p class="text-gray-500">Average Date</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg text-center">
                    <h3 class="font-semibold text-lg mb-2">Last Frost</h3>
                    <p id="last-frost-display" class="text-2xl text-blue-accent">N/A</p>
                    <div id="last-frost-gauge" class="thermometer-gauge my-2"></div>
                    <p class="text-gray-500">Average Date</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg text-center">
                    <h3 class="font-semibold text-lg mb-2">Total Growing Space</h3>
                    <p id="total-space-display" class="text-2xl text-green-accent">60 sq ft</p>
                    <p id="bed-count-display" class="text-gray-500">Across 7 Raised Beds</p>
                </div>
            </div>
            <div id="todo-now" class="mt-8 bg-yellow-accent bg-opacity-20 border-l-4 border-yellow-accent text-yellow-accent p-4 rounded-r-lg" role="alert">
                <p id="todo-header" class="font-bold">What to Do Now</p>
                <p id="todo-week">Loading weekly tasks…</p>
                <p id="todo-month" class="mt-2">Loading monthly tasks…</p>
            </div>
        </section>

        <section id="timeline" class="mb-12 scroll-mt-24">
            <h2 class="text-3xl font-bold mb-2 text-center">Planting Timeline</h2>
            <p class="text-center text-gray-600 mb-6">This chart shows the planting window and estimated time to first harvest for your crops. Click a month to filter the Plant Library below.</p>
            <div class="chart-container">
                <canvas id="timelineChart"></canvas>
            </div>
        </section>

        <section id="layouts" class="mb-12 scroll-mt-24">
            <h2 class="text-3xl font-bold mb-2 text-center">Interactive Bed Layouts</h2>
            <p class="text-center text-gray-600 mb-6">Visualize your garden. Hover over a square to see what's planted. Use the buttons to switch between bed types.</p>
            <div class="flex justify-center flex-wrap gap-2 mb-6" id="bed-type-selector"></div>
            <div class="flex justify-center mb-4">
                <button id="add-bed-btn" class="bg-green-accent text-white px-4 py-2 rounded-full hover:bg-opacity-80 transition">Add Bed</button>
            </div>
            <div id="bed-layout-container"></div>
        </section>

        <section id="plants" class="mb-12 scroll-mt-24">
            <h2 class="text-3xl font-bold mb-2 text-center">Plant Library</h2>
            <p class="text-center text-gray-600 mb-6">Explore your available seeds. Click any card for detailed planting info. The list is filtered by the timeline above.</p>
            <div class="flex justify-center mb-4 gap-2">
                <button id="add-plant-btn" class="bg-green-accent text-white px-4 py-2 rounded-full hover:bg-opacity-80 transition">Add Plant</button>
                <button id="reset-filter-btn" class="bg-accent text-white px-4 py-2 rounded-full hover:bg-opacity-80 transition">Show All Plants</button>
            </div>
            <div id="plant-library" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"></div>
        </section>

        <section id="swaps" class="mb-12 scroll-mt-24">
            <h2 class="text-3xl font-bold mb-2 text-center">Possible Swaps for High-Risk Plants</h2>
            <p class="text-center text-gray-600 mb-6">These plants are a "gamble" for a successful harvest starting July 27th. Consider swapping them for more timely and reliable fall crops. Click "Apply Swap" to update your plan.</p>
            <div id="swap-suggestions-container" class="space-y-6 max-w-4xl mx-auto"></div>
        </section>

        <section id="plan" class="mb-12 scroll-mt-24">
            <h2 class="text-3xl font-bold mb-2 text-center">Step-by-Step Action Plan</h2>
            <p class="text-center text-gray-600 mb-6">Your detailed guide from soil prep to final harvest. Use the filters to focus on specific plant types.</p>
            <div class="flex justify-center flex-wrap gap-2 mb-6" id="action-plan-filters">
                <button class="px-4 py-2 rounded-full bg-green-accent text-white filter-action-plan-btn" data-filter="All">All Plants</button>
                <button class="px-4 py-2 rounded-full bg-secondary filter-action-plan-btn" data-filter="Greens">Greens</button>
                <button class="px-4 py-2 rounded-full bg-secondary filter-action-plan-btn" data-filter="Fruiting">Fruiting</button>
                <button class="px-4 py-2 rounded-full bg-secondary filter-action-plan-btn" data-filter="Roots">Roots</button>
                <button class="px-4 py-2 rounded-full bg-secondary filter-action-plan-btn" data-filter="Herbs">Herbs</button>
                <button class="px-4 py-2 rounded-full bg-secondary filter-action-plan-btn" data-filter="Flowers">Flowers</button>
                <button class="px-4 py-2 rounded-full bg-secondary filter-action-plan-btn" data-filter="Other">Other</button>
            </div>
            <div id="action-plan-container" class="space-y-4 max-w-4xl mx-auto"></div>
            <div class="chart-container mt-8"><canvas id="milestoneChart"></canvas></div>

            <div class="flex justify-center mt-4" id="bed-timeline-controls"></div>
            <div class="chart-container mt-4"><canvas id="bedTimelineChart"></canvas></div>
        </section>

        <section id="seed-orders" class="mb-12 scroll-mt-24">
            <h2 class="text-3xl font-bold mb-2 text-center">Seeds to Order</h2>
            <p class="text-center text-gray-600 mb-6">This list tracks seeds needed for swapped plants not in your stash.</p>
            <ul id="seeds-to-order-list" class="list-disc list-inside max-w-2xl mx-auto space-y-1"></ul>
            <button id="download-seeds-btn" class="mt-4 bg-green-accent text-white px-4 py-2 rounded-full hover:bg-opacity-80 transition block mx-auto">Download Seed List</button>

        </section>
    </main>

    <div id="plantModal" class="modal" onclick="closeModal()">
        <div class="modal-content bg-white p-8 rounded-lg shadow-2xl w-11/12 md:w-2/3 lg:w-1/2 max-w-2xl" onclick="event.stopPropagation()">
            <div id="modal-body" class="space-y-4"></div>
            <button onclick="closeModal()" class="mt-6 w-full bg-accent text-white px-4 py-2 rounded-full hover:bg-opacity-80 transition">Close</button>
        </div>
    </div>
    <div id="plantFormModal" class="modal" onclick="closePlantFormModal()">
        <div class="modal-content bg-white p-8 rounded-lg shadow-2xl w-11/12 md:w-2/3 lg:w-1/2 max-w-2xl" onclick="event.stopPropagation()">
            <form id="plant-form" class="space-y-4">
                <input id="plant-name" type="text" class="w-full border p-2 rounded" placeholder="Name" required>
                <input id="plant-emoji" type="text" class="w-full border p-2 rounded" placeholder="Emoji">
                <input id="plant-viability" type="text" class="w-full border p-2 rounded" placeholder="Viability">
                <input id="plant-method" type="text" class="w-full border p-2 rounded" placeholder="Method">
                <input id="plant-window" type="text" class="w-full border p-2 rounded" placeholder="Planting Window">
                <input id="plant-spacing" type="number" class="w-full border p-2 rounded" placeholder="Spacing">
                <input id="plant-maturity" type="text" class="w-full border p-2 rounded" placeholder="Maturity">
                <input id="plant-notes" type="text" class="w-full border p-2 rounded" placeholder="Notes">
                <input id="plant-type" type="text" class="w-full border p-2 rounded" placeholder="Type">
                <input id="plant-month" type="number" class="w-full border p-2 rounded" placeholder="Planting Month">
                <div class="flex gap-2">
                    <button type="submit" class="flex-1 bg-green-accent text-white px-4 py-2 rounded">Save</button>
                    <button type="button" onclick="closePlantFormModal()" class="flex-1 bg-secondary px-4 py-2 rounded">Cancel</button>
                </div>
            </form>
        </div>
    </div>
    <div id="bedFormModal" class="modal" onclick="closeBedFormModal()">
        <div class="modal-content bg-white p-8 rounded-lg shadow-2xl w-11/12 md:w-1/3 lg:w-1/4 max-w-md" onclick="event.stopPropagation()">
            <form id="bed-form" class="space-y-4">
                <input id="bed-name" type="text" class="w-full border p-2 rounded" placeholder="Bed Name" required>
                <input id="bed-cols" type="number" class="w-full border p-2 rounded" placeholder="Columns" min="1" required>
                <input id="bed-rows" type="number" class="w-full border p-2 rounded" placeholder="Rows" min="1" required>
                <div class="flex gap-2">
                    <button type="submit" class="flex-1 bg-green-accent text-white px-4 py-2 rounded">Save</button>
                    <button type="button" onclick="closeBedFormModal()" class="flex-1 bg-secondary px-4 py-2 rounded">Cancel</button>
                </div>
            </form>
        </div>
    </div>
    <div id="locationFormModal" class="modal" onclick="closeLocationFormModal()">
        <div class="modal-content bg-white p-8 rounded-lg shadow-2xl w-11/12 md:w-1/3 max-w-md" onclick="event.stopPropagation()">
            <div class="space-y-4">
                <input id="zip-input" type="text" class="w-full border p-2 rounded" placeholder="ZIP Code">
                <div class="flex gap-2">
                    <button id="save-location-btn" class="flex-1 bg-green-accent text-white px-4 py-2 rounded">Save</button>
                    <button type="button" onclick="closeLocationFormModal()" class="flex-1 bg-secondary px-4 py-2 rounded">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    <script type="module" src="app.js"></script>

</body>
</html>
